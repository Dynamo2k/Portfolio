---
// NOTE: To enable the contact form, replace 'xform' with your actual Formspree form ID
// Sign up at https://formspree.io and create a new form to get your ID
---

<form
  action="https://formspree.io/f/xform"
  method="POST"
  class="space-y-6"
  id="contact-form"
  novalidate
>
  <div>
    <label for="name" class="block text-sm font-medium text-text-primary mb-1">
      Name <span class="text-danger" aria-hidden="true">*</span>
    </label>
    <input
      type="text"
      id="name"
      name="name"
      required
      aria-required="true"
      class="w-full px-4 py-3 bg-bg-elevated border border-accent-primary/20 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:border-accent-primary focus:ring-1 focus:ring-accent-primary transition-colors"
      placeholder="Your name"
    />
  </div>
  <div>
    <label for="email" class="block text-sm font-medium text-text-primary mb-1">
      Email <span class="text-danger" aria-hidden="true">*</span>
    </label>
    <input
      type="email"
      id="email"
      name="email"
      required
      aria-required="true"
      class="w-full px-4 py-3 bg-bg-elevated border border-accent-primary/20 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:border-accent-primary focus:ring-1 focus:ring-accent-primary transition-colors"
      placeholder="your@email.com"
    />
  </div>
  <div>
    <label for="subject" class="block text-sm font-medium text-text-primary mb-1">
      Subject
    </label>
    <input
      type="text"
      id="subject"
      name="subject"
      class="w-full px-4 py-3 bg-bg-elevated border border-accent-primary/20 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:border-accent-primary focus:ring-1 focus:ring-accent-primary transition-colors"
      placeholder="Subject of your message"
    />
  </div>
  <div>
    <label for="message" class="block text-sm font-medium text-text-primary mb-1">
      Message <span class="text-danger" aria-hidden="true">*</span>
    </label>
    <textarea
      id="message"
      name="message"
      required
      aria-required="true"
      rows="5"
      minlength="10"
      class="w-full px-4 py-3 bg-bg-elevated border border-accent-primary/20 rounded-lg text-text-primary placeholder-text-muted focus:outline-none focus:border-accent-primary focus:ring-1 focus:ring-accent-primary transition-colors resize-y"
      placeholder="Your message (minimum 10 characters)"
    ></textarea>
  </div>
  <button
    type="submit"
    class="btn-primary w-full justify-center"
    id="submit-btn"
  >
    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <line x1="22" y1="2" x2="11" y2="13"></line>
      <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
    </svg>
    <span>Send Message</span>
  </button>
  <div id="form-status" class="hidden text-center p-4 rounded-lg text-sm" role="alert"></div>
</form>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn');
  const statusDiv = document.getElementById('form-status');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    if (submitBtn) {
      submitBtn.innerHTML = `
        <svg class="animate-spin" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10" opacity="0.25"></circle>
          <path d="M4 12a8 8 0 0 1 8-8" opacity="0.75"></path>
        </svg>
        <span>Sending...</span>
      `;
      submitBtn.setAttribute('disabled', 'true');
    }

    try {
      const response = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { Accept: 'application/json' },
      });

      if (statusDiv) {
        if (response.ok) {
          statusDiv.className = 'block text-center p-4 rounded-lg text-sm bg-success/20 text-green-400';
          statusDiv.textContent = "Message sent! I'll get back to you within 24-48 hours.";
          form.reset();
        } else {
          statusDiv.className = 'block text-center p-4 rounded-lg text-sm bg-danger/20 text-red-400';
          statusDiv.textContent = 'Something went wrong. Please email me directly at ranauzair370@gmail.com';
        }
      }
    } catch {
      if (statusDiv) {
        statusDiv.className = 'block text-center p-4 rounded-lg text-sm bg-danger/20 text-red-400';
        statusDiv.textContent = 'Something went wrong. Please email me directly at ranauzair370@gmail.com';
      }
    } finally {
      if (submitBtn) {
        submitBtn.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
          <span>Send Message</span>
        `;
        submitBtn.removeAttribute('disabled');
      }
    }
  });
</script>
